(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1099:function(t,e,n){"use strict";n(31),n(20),n(22),n(34),n(35);var r=n(7),c=n(12),o=(n(30),n(14)),filter=n(121),l=n.n(filter),d=n(948),f=n(938);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={components:{StatusIcon:d.a},props:{job:{type:Object,required:!0}},data:function(){return{loading:!1}},computed:h(h({},Object(o.d)("current-build",["build"])),{},{canTrigger:function(){var t=this,e=l()(this.build.stages,(function(e){return e.number<t.job.stage_number})),n=l()(this.build.stages,(function(e){return e.number<t.job.stage_number&&Object(f.f)(e.status)}));return this.job.manual&&Object(f.c)(this.job.status)&&e.length===n.length}}),methods:h(h({},Object(o.b)("current-build",["runManualJob"])),{},{triggerJob:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loading=!0,n.next=4,e.runManualJob(t);case 4:n.next=10;break;case 6:n.prev=6,n.t0=n.catch(0),r=n.t0.response,e.$message.error(r.data.message);case 10:return n.prev=10,e.loading=!1,n.finish(10);case 13:case"end":return n.stop()}}),n,null,[[0,6,10,13]])})))()}})},j=n(6),component=Object(j.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"inline-flex items-center",on:{click:function(e){e.preventDefault(),!t.loading&&t.canTrigger&&t.triggerJob(t.job)}}},[n("StatusIcon",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"flex-shrink-0 mr-2",class:{"animate-bounce":t.canTrigger},attrs:{title:"Run manual",disabled:!t.canTrigger,"can-trigger":t.canTrigger,status:t.job.status}})],1)}),[],!1,null,null,null);e.a=component.exports},1134:function(t,e,n){t.exports={card:"card_QXGIy"}},1390:function(t,e,n){"use strict";var r=n(1134),c=n.n(r);n.d(e,"default",(function(){return c.a}))},1463:function(t,e,n){"use strict";n.r(e);n(31),n(20),n(22),n(34),n(35);var r=n(12),c=n(23),o=n.n(c),l=n(14),filter=(n(38),n(121)),d=n.n(filter),f=n(26),m=n.n(f),h=n(340),v=n.n(h),j=n(938),O=n(1099),y=n(948),_=n(972),w={components:{TriggerJob:O.a,StatusIcon:y.a,Timer:_.a},props:{build:{type:Object,required:!0}},methods:{canManualTrigger:function(t){return t.manual&&Object(j.c)(t.status)},stageURL:function(t){var e=t.jobs[0].hash_id,n=this.build.repository,r=n.scm,c=n.namespace,o=n.name;return"/".concat(r,"/").concat(c,"/").concat(o,"/builds/").concat(this.build.number,"/jobs/").concat(e)},jobURL:function(t){var e=this.build.repository,n=e.scm,r=e.namespace,c=e.name;return"/".concat(n,"/").concat(r,"/").concat(c,"/builds/").concat(this.build.number,"/jobs/").concat(t.hash_id)},getStatus:function(t){var e=t.status;return"passed"===e&&m()(t.jobs,{status:"failed",allow_failure:!0})?"passed with warning":e},statusComment:function(t){if(Object(j.k)(t.status))return"Waiting";if("failed"===t.status){var e=d()(t.jobs,{status:"failed"}).length;return"".concat(e," ").concat(e>1?"jobs":"job"," failed")}return v()(this.getStatus(t))}}},x=n(1390),T=n(6);var k=Object(T.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex items-start"},t._l(t.build.stages,(function(e){return n("ElCard",{key:e.id,class:t.$style.card},[n("div",{staticClass:"p-4",attrs:{slot:"header"},slot:"header"},[n("nuxt-link",{attrs:{to:t.stageURL(e)}},[n("div",{staticClass:"flex items-center mb-1"},[n("StatusIcon",{staticClass:"mr-2",attrs:{status:t.getStatus(e)}}),t._v("\n                    "+t._s(e.name)+"\n                ")],1)]),t._v(" "),n("span",{staticClass:"text-gray-500 text-sm"},[t._v(t._s(t.statusComment(e)))])],1),t._v(" "),t._l(e.jobs,(function(e){return n("nuxt-link",{key:e.id,attrs:{to:t.jobURL(e)}},[n("div",{staticClass:"flex items-center justify-between px-4 py-3 hover:bg-gray-100"},[n("div",{staticClass:"flex items-center flex-shrink min-w-0"},[t.canManualTrigger(e)?n("TriggerJob",{attrs:{job:e}}):n("StatusIcon",{staticClass:"flex-shrink-0 mr-2",attrs:{status:e.status,manual:e.manual}}),t._v(" "),n("div",{staticClass:"overflow-hidden truncate"},[t._v("\n                        "+t._s(e.name)+"\n                    ")])],1),t._v(" "),n("ElTooltip",[n("div",{attrs:{slot:"content"},slot:"content"},[n("Ionicon",{attrs:{name:"hourglass",size:"xs"}}),t._v("\n                        Queued: "+t._s(t._f("formatDuration")(e.queue_duration))+"\n                    ")],1),t._v(" "),n("div",{staticClass:"text-gray-500 flex items-center"},["running"===e.status?n("Timer",{attrs:{"start-time":e.started_at}}):n("span",{staticClass:"text-gray-500"},[n("Ionicon",{attrs:{name:"stopwatch",size:"xs"}}),t._v("\n                            "+t._s(t._f("formatDuration")(e.duration))+"\n                        ")],1)],1)])],1)])}))],2)})),1)}),[],!1,(function(t){this.$style=x.default.locals||x.default}),null,null).exports,S=n(951);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var C={name:"BuildStages",components:{Stages:k},middleware:function(t){var e=t.params,n=t.store,r=t.redirect;o()(n,"state.current-build.build.config_error",!1)&&r("/".concat(e.scm,"/").concat(e.namespace,"/").concat(e.repository,"/builds/").concat(e.number,"/config"))},validate:function(t){var e=t.params;return Object(S.a)(e.scm)},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(l.d)("current-build",["build"])),mounted:function(){this.$gtag.pageview({page_title:"Build Details",page_path:this.$route.path,page_location:window.location.href})}},D=Object(T.a)(C,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("Stages",{attrs:{build:t.build}})}),[],!1,null,null,null);e.default=D.exports},938:function(t,e,n){"use strict";n.d(e,"i",(function(){return o})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"j",(function(){return f})),n.d(e,"g",(function(){return m})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return v})),n.d(e,"e",(function(){return j})),n.d(e,"k",(function(){return O})),n.d(e,"b",(function(){return y})),n.d(e,"a",(function(){return _})),n.d(e,"l",(function(){return w}));var r=n(880),c=n.n(r),o=function(t){return"running"===t},l=function(t){return"passed"===t},d=function(t){return"failed"===t},f=function(t){return"skipped"===t},m=function(t){return"pending"===t},h=function(t){return"queued"===t},v=function(t){return"created"===t},j=function(t){return c()(["passed","failed","canceled","skipped"],t)},O=function(t){return c()(["pending","queued","running"],t)},y=function(t){return j(t)&&!f(t)},_=function(t){return o(t)||m(t)||h(t)},w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=arguments.length>2?arguments[2]:void 0;switch(t){case"passed":return"".concat(e,"-green-500");case"failed":return"".concat(e,"-red-500");case"running":return"".concat(e,"-blue-500");case"pending":return"".concat(e,"-gray-500");case"passed with warning":return"".concat(e,"-yellow-600");case"created":return"".concat(e,n?"-orange-600":"-gray-500");default:return"".concat(e,"-gray-600")}}},948:function(t,e,n){"use strict";n(174);var r=n(340),c=n.n(r),o=n(938),l={props:{status:{type:String,required:!0},size:{type:[String,Number],default:"base"},variant:{type:String,default:"outline"},withText:{type:Boolean,default:!1},rounded:{type:Boolean,default:!0},canTrigger:{type:Boolean,default:!1}},computed:{icon:function(){switch(this.status){case"passed":return"checkmark-circle";case"failed":case"canceled":return"close-circle";case"running":return"logo-ionic";case"skipped":return"play-forward-circle";case"passed with warning":return"alert-circle";case"created":return this.canTrigger?"play":"remove-circle";default:return"remove-circle"}},color:function(){var t="queued"===this.status?"pending":this.status,e=this.withText?"bg":"text";return Object(o.l)(t,e,this.canTrigger)},spin:function(){return{"spin animate--very-slowly":"running"===this.status}},text:function(){var t="queued"===this.status?"pending":this.status;return c()(t)}}},d=n(6),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.withText?n("div",{staticClass:"inline-flex items-center py-1 pl-2 pr-3",class:[t.color,{"rounded-md":t.rounded}]},[n("Ionicon",{staticClass:"text-white mr-1",class:t.spin,attrs:{name:t.icon,size:t.size,variant:"filled"}}),t._v(" "),n("span",{staticClass:"text-white leading-3",class:"text-"+t.size},[t._v("\n        "+t._s(t.text)+"\n    ")])],1):n("Ionicon",{class:[t.color,t.spin],attrs:{name:t.icon,size:t.size,variant:t.variant}})}),[],!1,null,null,null);e.a=component.exports},951:function(t,e,n){"use strict";function r(t){return/(^(?!:\/\/)(?=.{1,255}$)((.{1,63}\.){1,127}(?![0-9]*$)[a-z0-9-]+\.?)$)|^github$|^gitlab$|^bitbucket$/i.test(t)}n.d(e,"a",(function(){return r}))},972:function(t,e,n){"use strict";n(174);var r=n(562),c=n(912),o={props:{startTime:{type:[String,Number],required:!0},icon:String},data:function(){return{timeElapsed:Object(r.a)(Date.now(),Object(c.a)(this.startTime))}},watch:{startTime:"startTimer"},mounted:function(){this.startTimer()},beforeDestroy:function(){this.clearTimer()},methods:{tick:function(){this.timeElapsed=Object(r.a)(Date.now(),Object(c.a)(this.startTime))},startTimer:function(){this.$_interval||(this.$_interval=setInterval(this.tick,1e3))},clearTimer:function(){this.$_interval&&clearInterval(this.$_interval)}}},l=n(6),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.timeElapsed>0?n("span",[t.icon?n("i",{class:t.icon}):t._e(),t._v("\n    "+t._s(t._f("formatDuration")(t.timeElapsed))+"\n")]):t._e()}),[],!1,null,null,null);e.a=component.exports}}]);